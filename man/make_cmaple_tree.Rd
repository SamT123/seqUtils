% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/make_cmaple_tree.R
\name{make_cmaple_tree}
\alias{make_cmaple_tree}
\title{Build a phylogenetic tree using CMAPLE}
\usage{
make_cmaple_tree(
  sequences,
  tree_path,
  multifurcating = TRUE,
  starting_tree_path = NULL,
  freeze_starting_tree = FALSE,
  cmaple_path = NULL,
  out_sequence = NULL,
  num_threads = "AUTO",
  model = "GTR",
  keep_files = c("nwk", "log"),
  return_tree = TRUE
)
}
\arguments{
\item{sequences}{Named character vector of DNA or RNA sequences. All sequences
must have unique names.}

\item{tree_path}{Character string specifying the file path where the tree will
be saved. A log file will also be created at \code{paste0(tree_path, ".log")}.}

\item{multifurcating}{Logical. If \code{TRUE} (default), the output tree may
contain multifurcations (polytomies). If \code{FALSE}, the tree will be
strictly bifurcating.}

\item{starting_tree_path}{Optional character string specifying a path to a
starting tree file (Newick format) containing a subset of the sequences.
CMAPLE will add the remaining sequences to this tree. Default is \code{NULL}.}

\item{freeze_starting_tree}{Logical. If \code{TRUE}, relationships in the
starting tree are preserved (uses NORMAL search). If \code{FALSE} (default),
CMAPLE may rearrange the topology (uses EXHAUSTIVE search). Only relevant
when \code{starting_tree_path} is provided.}

\item{cmaple_path}{Optional character string specifying the directory containing
the CMAPLE executable. If provided, this path will be added to the system PATH.
If \code{NULL} (default), assumes CMAPLE is already in PATH.}

\item{out_sequence}{Optional character string specifying the name of a sequence
to use as the outgroup for rooting the tree. Must match one of the sequence
names. If \code{NULL} (default), the tree is ladderized but not explicitly rooted.}

\item{num_threads}{Character string or numeric specifying the number of threads
for CMAPLE to use. Default is \code{"AUTO"} which lets CMAPLE choose automatically.}

\item{model}{Character string specifying the substitution model. Default is
\code{"GTR"} (General Time Reversible).}

\item{keep_files}{Character vector specifying which files to keep after CMAPLE
execution. Valid options are \code{"nwk"} (tree file), \code{"fasta"}
(alignment file), and \code{"log"} (log file). Default is \code{c("nwk", "log")}.
Note: \code{"nwk"} can only be omitted when \code{return_tree = TRUE}.}

\item{return_tree}{Logical. If \code{TRUE} (default), returns the tree object
(phylo class). If \code{FALSE}, returns the file path as a character string.}
}
\value{
If \code{return_tree = TRUE}, returns a phylogenetic tree object of class
\code{phylo} (from the \code{ape} package). If \code{return_tree = FALSE},
returns a character string containing the path to the saved tree file.
}
\description{
Constructs a maximum likelihood phylogenetic tree from DNA/RNA sequences using
CMAPLE (Comprehensive Maximum Likelihood Phylogeny Estimation). The tree is
optionally ladderized and rooted before being returned.
}
\details{
CMAPLE is a fast maximum likelihood phylogenetic inference tool. This function
provides a convenient R wrapper that handles input/output files, parameter
configuration, and tree post-processing (ladderizing and rooting).

If \code{freeze_starting_tree = TRUE}, CMAPLE uses NORMAL search mode which
preserves relationships in the starting tree. If \code{FALSE}, EXHAUSTIVE
search mode is used which may rearrange the starting tree topology.
}
\examples{
\dontrun{
# Basic usage
sequences <- c(seq1 = "ATCG", seq2 = "ATCC", seq3 = "TTCG")
tree <- make_cmaple_tree(sequences, tree_path = "my_tree.nwk")

# With a starting tree and custom parameters
tree <- make_cmaple_tree(
  sequences,
  tree_path = "my_tree.nwk",
  starting_tree_path = "starting.nwk",
  freeze_starting_tree = TRUE,
  out_sequence = "seq3",
  num_threads = 4,
  model = "GTR"
)

# Keep only the tree file (delete fasta and log)
tree <- make_cmaple_tree(
  sequences,
  tree_path = "my_tree.nwk",
  keep_files = "nwk"
)

# Delete all files, only return tree object
tree <- make_cmaple_tree(
  sequences,
  tree_path = "my_tree.nwk",
  keep_files = character(0),
  return_tree = TRUE
)
}
}
